---
title: English Premier League 19/20
author: Gerardo Moreno
date: '2020-12-09'
slug: english-premier-league-19-20
categories: [English Premier League, R, data science]
tags: [R, blogdown]
---
```{r, message=FALSE}
library(here)
library(ggplot2)
library(tidyverse)
library(readxl)
library(tinytex)
library(fivethirtyeight)
knitr::opts_chunk$set(echo = FALSE, tidy = TRUE)
epl1 <- read.csv(file = here::here("epl_data", "epl2020.csv"))
epl2 <- read.csv(file = here::here("epl_data", "EPL_19_20_GW_Timeseries.csv"))
epl3 <- read.csv(file = here::here("epl_data", "epl_players_stats.csv"))
epl4 <- read.csv(file = here::here("epl_data", "players_1920_fin.csv"))
```
For this project, I am examining the English Premier League statistics by players stats, like height/age compared to their respective position. For example, in the datasets "epl_players_stats.csv" and "players_1920_fin.csv" from FiveThirtyEight, the file goes into full detail about players like height, position, goals per game, goals given up, age, ect, so I will be examining if a player if more likely to succeed in this league based on their height or age. The "players_1920_fin.csv"" there were 22,502 observations and 35 Variables, and "epl_players_stats.csv" has 522 observations and 41 variables. The variable codes is a factor with multiple levels explaing what teams each player plays for and their statistics for the 19/20 season.

The other two datasets "EPL_19_20_GW_Timeseries.csv" and "epl2020.csv" go into detail for the 19/20 statitics for each team in the English Premier League. In these data sets, we can find the results week by week of each team in the EPL and variable like win's, loss's, ties, points gained, goals given up, goals scored, ect.. The "EPL_19_20_GW_Timeseries.csv" has 1,048,575 observations and 77 variable and the "epl2020.csv" data set consits of 576 observations and 45 variables. These files have many levels going into full detail week by week, so i will have many outcomes to analyze.

*Question 1: First, do soccer players score more goals based on their height? I will analyze each players statistics for the 19/20 season based off their heights. Go into detail about if tall players score more goals than short players or vise versa. The measurement will be based off the overall median height of every player in the league. To test this, I will be putting the data organized in a data visualization like a scatter plot.
```{r}
head(epl3)
```
```{r}
epl3 %>%
  summarise(avg_height = mean(height))

#epl3 %>%
#  select(name, position, height, weight, goals, games) %>%
#  filter(games >10, position != "Goalkeeper", goals > 1) %>%
#  ggplot(aes(x = goals, y = height)) +
#  geom_boxplot() +
# geom_jitter() +
#  ylim(165,200) +
# facet_wrap(~ position)

epl3 %>%
  select(name, position, height, weight, goals, games) %>%
  filter(games >10, position != "Goalkeeper", goals > 1) %>%
  ggplot(aes(x = height, y = goals)) +
  geom_vline(xintercept = 175.4, linetype = "dashed", color = "blue") +
  geom_boxplot(fill = "purple4") +
  geom_jitter() +
  xlim(165,200) +
  facet_wrap(~ position) 
```
The boxplot graph above shows the data for each position. The blue dashed line shows the average height of the players in the English Premier League, which is 175.4 cm or 5'7 ft. So, the results show that taller players tend to score more as forwards, which is surprising to me, as I would think a bit shorter, more agile player would be more effective.

*Question 2: Second, do teams tend to preform better with older, experienced players or young, talented players. Getting the average age of the players for each team and basing that with their results. Respectively, comparing if they score more goals, prevent more goals, and their wins, then plotting this into a bar chart.
```{r}
head(epl2) 
epl2 %>%
  filter(GW38_Points > 1) %>%
  select(Teams, GW38_Points, GW38_Standing)
```
```{r}
#head(epl3) 
epl3 %>%
  select(name, age, team) %>%
  group_by(team) %>%
  summarise(avg_age = mean(age))

epl2 %>%
  filter(GW38_Points > 1) %>%
  select(Teams, GW38_Points, GW38_Standing)
```
Using both of these data sets, I will join them by name and create just one data set that is easiy to read. Then i will graph them to show if the average age of players on each team correlates with the amount of wins.

*Question 3: Third, overall, do teams that spend more money correlate to their performance. Do team that spend more money obtaining and paying more players translate to more wins. I will be comparing the total amount spent by each team and comparing them in a bar chart. 

Need to find a more organized data set that shows the amount of money each soccer club spent in the league. Then, I will join that to the results of the ending of the season standing.

*Question 4: Fourth, To be announced.

**Conclusion**

More analysis and question to come.

*To be Determined